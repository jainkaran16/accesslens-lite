:root {
  --all-min-font: 16px;
  --all-line-height: 1.6;
  --all-letter-spacing: 0.02em;
  --all-word-spacing: 0.04em;

  --all-focus-ring: 3px solid #005fcc;
  --all-focus-shadow: 0 0 0 3px rgba(0,95,204,0.3);

  --all-ruler-height: 28px;
  --all-focus-padding: 12px;

  --all-dim-opacity: 0.15;

  /* Low-vision: ideal reading width (JS may widen via clamp) */
  --all-max-measure: 66ch;
}

/* Global enable flag */
html.all-enabled {
  scroll-behavior: auto !important;
}

/* Typography scaling */
html.all-enabled {
  font-size: var(--all-min-font);
}
html.all-enabled body,
html.all-enabled body * {
  line-height: var(--all-line-height);
  letter-spacing: var(--all-letter-spacing);
  word-spacing: var(--all-word-spacing);
}

/* Respect author letter/word spacing where explicitly set */
html.all-enabled [data-all-ignore-spacing],
html.all-enabled [data-all-ignore-spacing] * {
  letter-spacing: normal !important;
  word-spacing: normal !important;
}

/* Low-vision reading container measure */

html.all-lowvision [data-all-measure] {
  max-width: var(--all-max-measure);
  margin-inline: auto;
}

/* Relax ancestor clamps when JS marks them */
html.all-lowvision [data-all-unclamp] {
  max-width: none !important;
  inline-size: auto !important;
  width: auto !important;
}

/* Strong focus styles */
html.all-enabled :where(a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])):focus-visible {
  outline: var(--all-focus-ring) !important;
  box-shadow: var(--all-focus-shadow) !important;
  outline-offset: 2px !important;
}

/* Only add the very strong focus ring when requested */
html.all-enabled:not(.all-kb-strong) :where(a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])):focus-visible {
  box-shadow: none !important;
}

/* Skip link */
.all-skip-link {
  position: fixed;
  top: 0.5rem;
  left: 0.5rem;
  padding: 0.5rem 1rem;
  background: #005fcc;
  color: #fff;
  z-index: 999999;
  border-radius: 999px;
  font-size: 0.9rem;
  text-decoration: none;
  transform: translateY(-150%);
  transition: transform 0.15s ease-out;
}
.all-skip-link:focus-visible {
  transform: translateY(0);
}

/* Section focus outlines when "navigateSections" is on */
html.all-kb-sections [data-all-section-focus]:focus-visible {
  outline: var(--all-focus-ring) !important;
  outline-offset: var(--all-focus-padding) !important;
}

/* Reading ruler */
.all-ruler {
  position: fixed;
  left: 0;
  right: 0;
  pointer-events: none;
  height: var(--all-ruler-height);
  background: rgba(255, 255, 0, 0.12);
  border-top: 1px solid rgba(0, 0, 0, 0.15);
  border-bottom: 1px solid rgba(0, 0, 0, 0.15);
  z-index: 999995;
}

/* Focus mode dimmer */
.all-dim-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, var(--all-dim-opacity));
  pointer-events: none;
  z-index: 999990;
}

/* Motion helpers */
html.all-no-snaps {
  scroll-snap-type: none !important;
}
html.all-no-snaps * {
  scroll-snap-align: none !important;
}

html.all-no-parallax {
  background-attachment: scroll !important;
}
html.all-no-parallax * {
  background-attachment: scroll !important;
}

/* GIF freeze hint */
img[data-all-gif-frozen="1"] {
  image-rendering: auto !important;
}

/* Ignore zones */
[data-all-ignore],
[data-all-ignore] * {
  letter-spacing: normal !important;
  word-spacing: normal !important;
  line-height: normal !important;
  max-width: none !important;
}

/* Colour-blind Assist helpers */
html.all-cb-sim.all-cb-noimg :is(img, video, canvas, picture) {
  filter: none !important;
}
html.al-always-underline a {
  text-decoration: underline !important;
  text-underline-offset: 2px;
}
html.al-visited-dash a:visited {
  text-decoration-style: dashed !important;
}
.all-audit-color-only {
  outline: 2px dashed #d00 !important;
  outline-offset: 2px;
}

/* --- AccessLens Lite: additional low-vision refinements (scoped to reading container) --- */

/* Make the primary reading column comfortable and centered */
html.all-lowvision [data-all-measure] {
  /* Ideal reading width, but allow a bit wider on large screens and narrower on phones */
  max-width: clamp(66ch, var(--all-max-measure, 80ch), 92vw) !important;
  margin-inline: auto !important;
}

/* Paragraph and list spacing inside the reading container */
html.all-lowvision [data-all-measure] :where(p, li, dd, dt, blockquote, figcaption) {
  line-height: 1.7 !important;
  letter-spacing: 0.04em !important;
  word-spacing: 0.12em !important;
  margin-block: 0.75em 1.4em !important;
  text-align: left !important;
}

/* Heading spacing inside the reading container */
html.all-lowvision [data-all-measure] :where(h1, h2, h3, h4, h5, h6) {
  line-height: 1.3 !important;
  margin-block: 1em 0.5em !important;
  text-align: left !important;
}

/* Slightly stronger link cues inside the reading container */
html.all-lowvision [data-all-measure] a {
  text-decoration-thickness: 0.12em;
  text-underline-offset: 0.16em;
}

/* Slightly larger click targets for common controls in the reading area */
html.all-lowvision [data-all-measure]
  :where(button, [role="button"], input[type="button"], input[type="submit"], a[role="button"]) {
  min-height: 40px;
  padding-block: 0.4em;
  padding-inline: 0.8em;
}
